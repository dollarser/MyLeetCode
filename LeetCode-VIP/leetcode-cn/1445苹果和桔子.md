# 1445è‹¹æœå’Œæ¡”å­
<p>è¡¨: <code>Sales</code></p>

<pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| sale_date     | date    |
| fruit         | enum    | 
| sold_num      | int     | 
+---------------+---------+
(sale_date,fruit) æ˜¯è¯¥è¡¨ä¸»é”®.
è¯¥è¡¨åŒ…å«äº†æ¯ä¸€å¤©ä¸­&quot;è‹¹æœ&quot; å’Œ &quot;æ¡”å­&quot;çš„é”€å”®æƒ…å†µ.
</pre>

<p>&nbsp;</p>

<p>å†™ä¸€ä¸ª SQL&nbsp;æŸ¥è¯¢,&nbsp;æŠ¥å‘Šæ¯ä¸€å¤©&nbsp;<strong>è‹¹æœ</strong>&nbsp;å’Œ&nbsp;<strong>æ¡”å­</strong>&nbsp;é”€å”®çš„æ•°ç›®çš„å·®å¼‚.</p>

<p>è¿”å›çš„ç»“æœè¡¨,&nbsp;æŒ‰ç…§æ ¼å¼ä¸º&nbsp;(&#39;YYYY-MM-DD&#39;) çš„ <code>sale_date</code> æ’åº.</p>

<p>æŸ¥è¯¢ç»“æœè¡¨å¦‚ä¸‹ä¾‹æ‰€ç¤º:</p>

<p>&nbsp;</p>

<pre><code>Sales</code> è¡¨:
+------------+------------+-------------+
| sale_date  | fruit      | sold_num    |
+------------+------------+-------------+
| 2020-05-01 | apples     | 10          |
| 2020-05-01 | oranges    | 8           |
| 2020-05-02 | apples     | 15          |
| 2020-05-02 | oranges    | 15          |
| 2020-05-03 | apples     | 20          |
| 2020-05-03 | oranges    | 0           |
| 2020-05-04 | apples     | 15          |
| 2020-05-04 | oranges    | 16          |
+------------+------------+-------------+

Result è¡¨:
+------------+--------------+
| sale_date  | diff         |
+------------+--------------+
| 2020-05-01 | 2            |
| 2020-05-02 | 0            |
| 2020-05-03 | 20           |
| 2020-05-04 | -1           |
+------------+--------------+

åœ¨ 2020-05-01, å–äº† 10 ä¸ªè‹¹æœ å’Œ 8 ä¸ªæ¡”å­ (å·®å¼‚ä¸º 10 - 8 = 2).
åœ¨ 2020-05-02, å–äº† 15 ä¸ªè‹¹æœ å’Œ 15 ä¸ªæ¡”å­ (å·®å¼‚ä¸º 15 - 15 = 0).
åœ¨ 2020-05-03, å–äº† 20 ä¸ªè‹¹æœ å’Œ 0 ä¸ªæ¡”å­ (å·®å¼‚ä¸º 20 - 0 = 20).
åœ¨ 2020-05-04, å–äº† 15 ä¸ªè‹¹æœ å’Œ 16 ä¸ªæ¡”å­ (å·®å¼‚ä¸º 15 - 16 = -1).
</pre>
































# è§£é¢˜:
# 1.1445.è‹¹æœå’Œæ¡”å­
```mysql
# Write your MySQL query statement below
select sale_date,sum(case when fruit = "oranges" then -sold_num else sold_num end)as diff
from Sales
group by sale_date
order by sale_date;

# Write your MySQL query statement below
select sale_date,sum(if(fruit = "oranges",-sold_num,sold_num))as diff
from Sales
group by sale_date
order by sale_date;
```

# 2.ã€track & traningã€‘æ€è·¯ç®€å•ï¼Œæ€§èƒ½é«˜æ•ˆ
### æ–¹ä¾¿å¿«é€Ÿå­¦ä¹ ç®—æ³•ä¸ç†è§£~
ğŸŒ‡ ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ ä¸€é”®ä¸‰è¿ ~å…³æ³¨Jamï¼Œä»ä½ æˆ‘åšèµ·ï¼

**å…„å¼Ÿä¼šèƒŒå›ä½ ï¼Œå¥³äººä¼šç¦»å¼€ä½ ï¼Œé‡‘é’±ä¼šè¯±æƒ‘ä½ ï¼Œç”Ÿæ´»ä¼šåˆéš¾ä½ ï¼Œåªæœ‰æ•°å­¦ä¸ä¼šï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼š**
**å¤©æ‰ä¸å¦ï¼Œå–å†³äºæœ€ç»ˆè¾¾åˆ°çš„é«˜åº¦ã€‚çœŸæ­£çš„å¤©æ‰æ˜¯é‚£äº›è„šè¸å®åœ°çš„äºº**
**é™ä¸‹å¿ƒæ¥å¥½å¥½åšè‡ªå·±ï¼Œèµ°ç¨³è„šä¸‹æ¯ä¸€æ­¥ï¼Œå°±æ˜¯æœ€å¥½çš„è·¯ï¼Œå¼ºè€…éƒ½æ˜¯å­¤ç‹¬çš„**

æ¨è python ç®—æ³•çš„ä¹¦ç±ï¼Œä½“ç³»åŒ–å­¦ä¹ ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œç”¨æ­£ç¡®çš„æ–¹å¼æˆä¸ºofferæ”¶å‰²æœº
[leetcode](https://github.com/ls1248659692/leetcode) â€”â€”  **ç³»ç»ŸåŒ–å¿«é€Ÿå­¦ä¹ ç®—æ³•ï¼Œè¿™ä¸æ˜¯å†…å·ï¼Œè¿™åªæ˜¯æ‚„æ‚„åœ°åŠªåŠ›ï¼Œç„¶åæƒŠè‰³æ‰€æœ‰çš„äºº**
![image.png](https://pic.leetcode-cn.com/1649507486-ViuAab-image.png)

---
### æ±‚è§£æ€è·¯
CASE WHEN åšæ¡ä»¶åˆ¤æ–­

### ä»£ç 

```mysql
# Write your MySQL query statement below
SELECT sale_date,
    SUM(CASE WHEN fruit='apples' THEN sold_num ELSE -sold_num END) AS diff
FROM sales
GROUP BY sale_date
ORDER BY sale_date;
```
# 3.5ç§å†™æ³•
æœ€çŸ­å†™æ³•
SELECT sale_date,SUM(IF(fruit = 'apples',1,-1) * sold_num) diff
FROM Sales
GROUP BY sale_date
ORDER BY sale_date

å…¶ä»–å†™æ³•
![å›¾ç‰‡.png](https://pic.leetcode-cn.com/2d23405ee957aacab0b4627c1379fe0b893350ba3726ca6fbdb1a59f5c450504-%E5%9B%BE%E7%89%87.png)

# 4.SQL-ifã€group by
```sql
select 
    sale_date,
    sum(
        if(fruit = 'apples', sold_num, -sold_num)
    ) as diff
    from sales
group by sale_date
```

