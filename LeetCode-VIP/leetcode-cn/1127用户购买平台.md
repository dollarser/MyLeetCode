# 1127ç”¨æˆ·è´­ä¹°å¹³å°
<p>æ”¯å‡ºè¡¨: <code>Spending</code></p>

<pre>
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| user_id     | int     |
| spend_date  | date    |
| platform    | enum    | 
| amount      | int     |
+-------------+---------+
è¿™å¼ è¡¨è®°å½•äº†ç”¨æˆ·åœ¨ä¸€ä¸ªåœ¨çº¿è´­ç‰©ç½‘ç«™çš„æ”¯å‡ºå†å²ï¼Œè¯¥åœ¨çº¿è´­ç‰©å¹³å°åŒæ—¶æ‹¥æœ‰æ¡Œé¢ç«¯ï¼ˆ&#39;desktop&#39;ï¼‰å’Œæ‰‹æœºç«¯ï¼ˆ&#39;mobile&#39;ï¼‰çš„åº”ç”¨ç¨‹åºã€‚
è¿™å¼ è¡¨çš„ä¸»é”®æ˜¯ (user_id, spend_date, platform)ã€‚
å¹³å°åˆ— platform æ˜¯ä¸€ç§ ENUM ï¼Œç±»å‹ä¸ºï¼ˆ&#39;desktop&#39;, &#39;mobile&#39;ï¼‰ã€‚</pre>

<p>&nbsp;</p>

<p>å†™ä¸€æ®µ SQL æ¥æŸ¥æ‰¾æ¯å¤©&nbsp;<strong>ä»…&nbsp;</strong>ä½¿ç”¨æ‰‹æœºç«¯ç”¨æˆ·ã€<strong>ä»…&nbsp;</strong>ä½¿ç”¨æ¡Œé¢ç«¯ç”¨æˆ·å’Œ&nbsp;<strong>åŒæ—¶&nbsp;</strong>ä½¿ç”¨æ¡Œé¢ç«¯å’Œæ‰‹æœºç«¯çš„ç”¨æˆ·äººæ•°å’Œæ€»æ”¯å‡ºé‡‘é¢ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p>

<pre>
<code>Spending</code> table:
+---------+------------+----------+--------+
| user_id | spend_date | platform | amount |
+---------+------------+----------+--------+
| 1       | 2019-07-01 | mobile   | 100    |
| 1       | 2019-07-01 | desktop  | 100    |
| 2       | 2019-07-01 | mobile   | 100    |
| 2       | 2019-07-02 | mobile   | 100    |
| 3       | 2019-07-01 | desktop  | 100    |
| 3       | 2019-07-02 | desktop  | 100    |
+---------+------------+----------+--------+

Result table:
+------------+----------+--------------+-------------+
| spend_date | platform | total_amount | total_users |
+------------+----------+--------------+-------------+
| 2019-07-01 | desktop  | 100          | 1           |
| 2019-07-01 | mobile   | 100          | 1           |
| 2019-07-01 | both     | 200          | 1           |
| 2019-07-02 | desktop  | 100          | 1           |
| 2019-07-02 | mobile   | 100          | 1           |
| 2019-07-02 | both     | 0            | 0           |
+------------+----------+--------------+-------------+ 
åœ¨ 2019-07-01, ç”¨æˆ·1 <strong>åŒæ—¶ </strong>ä½¿ç”¨æ¡Œé¢ç«¯å’Œæ‰‹æœºç«¯è´­ä¹°, ç”¨æˆ·2 <strong>ä»… </strong>ä½¿ç”¨äº†æ‰‹æœºç«¯è´­ä¹°ï¼Œè€Œç”¨æˆ·3 <strong>ä»… </strong>ä½¿ç”¨äº†æ¡Œé¢ç«¯è´­ä¹°ã€‚
åœ¨ 2019-07-02, ç”¨æˆ·2 <strong>ä»… </strong>ä½¿ç”¨äº†æ‰‹æœºç«¯è´­ä¹°, ç”¨æˆ·3 <strong>ä»… </strong>ä½¿ç”¨äº†æ¡Œé¢ç«¯è´­ä¹°ï¼Œä¸”æ²¡æœ‰ç”¨æˆ· <strong>åŒæ—¶ </strong>ä½¿ç”¨æ¡Œé¢ç«¯å’Œæ‰‹æœºç«¯è´­ä¹°ã€‚</pre>
































# è§£é¢˜:
# 1.ã€é²¸æã€‘1127. ç”¨æˆ·è´­ä¹°å¹³å°ï¼ˆè€ƒç‚¹ï¼šcteã€unionã€ifï¼‰
##### æ€è·¯

é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ„é€ Resultä¹‹ä¸­çš„å‰ä¸¤åˆ—ï¼ˆcte1ï¼‰ï¼Œå¯ä»¥ç”¨unionç›´æ¥æŠŠbothåµŒè¿›å»ï¼Œç„¶åå†é€šè¿‡ã€æ¯äººæ¯å¤©ç”¨çš„ä¸åŒå¹³å°æ•°=2ã€‘çš„æ¡ä»¶å»å®šä¹‰ã€bothã€‘ï¼ˆcte2ï¼‰ï¼Œç„¶åå†left joinè®¡ç®—total_amount å’Œ total_users 

##### ç®—æ³•

1. è¦æ„é€ Resultä¹‹ä¸­çš„å‰ä¸¤åˆ—

```sql
with cte1 as
(
    select distinct spend_date, 'desktop'  as platform from spending
    union 
    select distinct spend_date, 'mobile' from spending
    union
    select distinct spend_date, 'both' from spending
)

# è¾“å‡º
{"headers": ["spend_date", "platform"], 
"values": [["2019-07-01", "desktop"], 
           ["2019-07-02", "desktop"], 
           ["2019-07-01", "mobile"], 
           ["2019-07-02", "mobile"], 
           ["2019-07-01", "both"], 
           ["2019-07-02", "both"]]}
```

2. å®šä¹‰ã€bothã€‘

```sql
cte2 as
(
select
    user_id,
    spend_date,
    if(count(distinct platform)=2,'both',platform) as platform,
    sum(amount) as amount
from spending
group by 1,2
)

# è¾“å‡º
{"headers": ["user_id", "spend_date", "platform", "amount"], 
"values": [[1, "2019-07-01", "both", 200], 
           [2, "2019-07-01", "mobile", 100], 
           [2, "2019-07-02", "mobile", 100], 
           [3, "2019-07-01", "desktop", 100], 
           [3, "2019-07-02", "desktop", 100]]}
```

3. left joinè®¡ç®—

```sql
select 
    t1.spend_date,
    t1.platform,
    ifnull(sum(t2.amount),0) as total_amount,
    ifnull(count(t2.user_id),0) as total_users
from cte1 t1
left join cte2 t2
using(spend_date,platform)
group by 1,2
```

##### ç­”æ¡ˆ

```sql
# Write your MySQL query statement below

with cte1 as
(
    select distinct spend_date, 'desktop'  as platform from spending
    union 
    select distinct spend_date, 'mobile' from spending
    union
    select distinct spend_date, 'both' from spending
),

cte2 as
(
select
    user_id,
    spend_date,
    if(count(distinct platform)=2,'both',platform) as platform,
    sum(amount) as amount
from spending
group by 1,2
)


select 
    t1.spend_date,
    t1.platform,
    ifnull(sum(t2.amount),0) as total_amount,
    ifnull(count(t2.user_id),0) as total_users
from cte1 t1
left join cte2 t2
using(spend_date,platform)
group by 1,2
```

ğŸ¥°è§‰å¾—è¿˜ä¸é”™çš„è¯ï¼Œç‚¹ä¸ªèµï¼ŒåŠ ä¸ªå…³æ³¨å§~ğŸ¥°
# 2.æ„é€ platformï¼Œä¸åšè¿æ¥è§£æ³•
### è§£é¢˜æ€è·¯
ç¬¬ä¸€æ­¥ï¼š
    ç»Ÿè®¡æ¯å¤©ä¸åŒå¹³å°çš„æ¶ˆè´¹é¢ï¼Œç±»ä¼¼äºå…¶ä»–çš„è´­ç‰©æŒ‡æ ‡æ¶ˆè´¹é¢ä¸€èˆ¬éƒ½æ˜¯ä»¥ç”¨æˆ·å’Œæ—¶é—´ä½œä¸ºåˆ†ç»„
    è¿™é“é¢˜çš„åˆ†ç»„æ˜¯æŒ‰ç”¨æˆ·å’Œæ—¶é—´å¤©ä¸ºåˆ†ç»„æ¡ä»¶
    group by user_id,spend_date
ç¬¬äºŒæ­¥ï¼š
    ä»'spending'è¡¨ä¸­æ„æˆå‡ºåˆ—'platform' å…·æœ‰å¦‚ä¸‹ä¸‰ä¸ªå­—æ®µ 'both' 'desktop' 'mobile' 
    æ¡ä»¶æ˜¯å½“'platform'è®¡æ•°å¤§äº2æ—¶è¾“å‡º è¡¨ä¸­ä¸å­˜åœ¨çš„å­—æ®µ 'both'
    if(count(distinct platform)=2,'both',platform)
    sum(amount)
ç¬¬ä¸‰æ­¥ï¼š
    å¯¹æˆ‘ä»¬é™ˆåˆ—æˆ‘ä»¬åœ¨çˆ¶æŸ¥è¯¢ä¸­éœ€è¦çš„ç”¨çš„åˆ—ï¼Œå¹¶å¯¹æ„é€ åˆ—è¿›è¡Œé‡å‘½åï¼Œæ•´ä½“å­æŸ¥è¯¢aè¡¨å¦‚ä¸‹
    (
    select spend_date,user_id,
    if(count(distinct platform)=2,'both',platform) as platform,
    sum(amount) as amount
    from spending
    group by user_id,spend_date
    ) a
ç¬¬å››æ­¥ï¼š
    ç¬¬äºŒæ­¥æ„é€ åˆ—ä¸­å¦‚æœå½“æ—¥æ²¡æœ‰åŒæ—¶ä½¿ç”¨'mobile'å’Œ'desktop'è´­ä¹°çš„ç”¨æˆ·ï¼Œå°±æ— æ³•è¾“å‡º'both'å­—æ®µ
    å› æ­¤æˆ‘ä»¬éœ€è¦æ„é€ å‡ºä¸€ä¸ªå›ºå®šè¾“å‡ºä¸‰ä¸ªå­—æ®µ 'both' 'desktop' 'mobile' çš„åˆ—ï¼Œåˆ™bè¡¨å¦‚ä¸‹
    (
    select 'desktop' as platform union
    select 'mobile' as platform union
    select 'both' as platform
    ) b
ç¬¬äº”æ­¥ï¼š
    é€šè¿‡ç­›é€‰æ¡ä»¶çš„åˆ—æŒ‰ç…§ï¼Œspend_date å’Œ platform ä½œä¸ºåˆ†ç»„å¯¹total_amount å’Œ total_userè¿›è¡Œç»Ÿè®¡
    group by spend_date,platform
ç¬¬å…­æ­¥ï¼š
    å› æ­¤ä¸éœ€è¦åšè¡¨é—´è¿æ¥ï¼Œå°±å¯ä»¥å®ç°ä¸‰ä¸ªå­—æ®µçš„å›ºå®šè¾“å‡ºï¼Œåˆ™ä¸éœ€è¦æ·»åŠ ä¸‰ä¸ªå­æŸ¥è¯¢ä»¥æ—¥æœŸä½œä¸ºè¿æ¥æ¡ä»¶
    åœ¨è¡¨ä¹‹é—´è¿›è¡Œç­›é€‰ï¼Œå½“ a.platform = b.platform æ—¶ç»Ÿè®¡amountï¼Œåˆ™çˆ¶æŸ¥è¯¢çš„é€‰æ‹©åˆ—ä¸º
    select spend_date,b.platform,
    sum(if(a.platform=b.platform,amount,0)) as total_amount,
    count(if(a.platform=b.platform,1,null)) as total_users
    from(a,b)
    group by spend_date,platform
ç¬¬ä¸ƒæ­¥ï¼š
    å°†åˆ†æ­¥è¿›è¡Œçš„æŸ¥è¯¢åˆå¹¶ä¸ºåŒä¸€æŸ¥è¯¢

![186678b939689b32be89f307396cb23.png](https://pic.leetcode-cn.com/1609739658-uJviRu-186678b939689b32be89f307396cb23.png)

### ä»£ç 

```mysql
select spend_date,b.platform,
sum(if(a.platform=b.platform,amount,0)) as total_amount,
count(if(a.platform=b.platform,1,null)) as total_users
from(
    select spend_date,user_id,
    if(count(distinct platform)=2,'both',platform) as platform,
    sum(amount) as amount
    from spending
    group by user_id,spend_date
) a,(
    select 'desktop' as platform union
    select 'mobile' as platform union
    select 'both' as platform
) b
group by spend_date,platform





```
# 3.ã€track & traningã€‘æ€è·¯ç®€å•ï¼Œæ€§èƒ½é«˜æ•ˆ
### æ–¹ä¾¿å¿«é€Ÿå­¦ä¹ ç®—æ³•ä¸ç†è§£~
ğŸŒ‡ ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ ä¸€é”®ä¸‰è¿ ~å…³æ³¨Jamï¼Œä»ä½ æˆ‘åšèµ·ï¼

**å…„å¼Ÿä¼šèƒŒå›ä½ ï¼Œå¥³äººä¼šç¦»å¼€ä½ ï¼Œé‡‘é’±ä¼šè¯±æƒ‘ä½ ï¼Œç”Ÿæ´»ä¼šåˆéš¾ä½ ï¼Œåªæœ‰æ•°å­¦ä¸ä¼šï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼š**
**å¤©æ‰ä¸å¦ï¼Œå–å†³äºæœ€ç»ˆè¾¾åˆ°çš„é«˜åº¦ã€‚çœŸæ­£çš„å¤©æ‰æ˜¯é‚£äº›è„šè¸å®åœ°çš„äºº**
**é™ä¸‹å¿ƒæ¥å¥½å¥½åšè‡ªå·±ï¼Œèµ°ç¨³è„šä¸‹æ¯ä¸€æ­¥ï¼Œå°±æ˜¯æœ€å¥½çš„è·¯ï¼Œå¼ºè€…éƒ½æ˜¯å­¤ç‹¬çš„**

æ¨è python ç®—æ³•çš„ä¹¦ç±ï¼Œä½“ç³»åŒ–å­¦ä¹ ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œç”¨æ­£ç¡®çš„æ–¹å¼æˆä¸ºofferæ”¶å‰²æœº
[leetcode](https://github.com/ls1248659692/leetcode) â€”â€”  **ç³»ç»ŸåŒ–å¿«é€Ÿå­¦ä¹ ç®—æ³•ï¼Œè¿™ä¸æ˜¯å†…å·ï¼Œè¿™åªæ˜¯æ‚„æ‚„åœ°åŠªåŠ›ï¼Œç„¶åæƒŠè‰³æ‰€æœ‰çš„äºº**
![image.png](https://pic.leetcode-cn.com/1649771039-XYXnfg-image.png)

---
### æ±‚è§£æ€è·¯
1. æ„å»ºæ¯ä¸ªç”¨æˆ·çš„è´­ä¹°æ•°æ®æŒ‰å¤©èšåˆ
```
SELECT 
	user_id,
	spend_date, 
	any_value(if(count(platform) = 2, 'both', platform)) platform,
	sum(amount) amount
FROM spending
GROUP BY user_id, spend_date
```
2. æ„å»ºæ¯å¤©æ•°æ®çš„å…¶ä»–ä¸‰ä¸ªæ¯ç±»æ•°æ®
```
SELECT 'mobile' platform union 
SELECT 'desktop' platform union
SELECT 'both' platform 
```
3. åˆ¤æ–­æ±‚å’Œ total_amount å’Œ total_users çš„æ¡ä»¶
```
sum(if(t1.platform = t2.platform, amount, 0)) total_amount
count(if(t1.platform = t2.platform, 1, NULL)) total_users
```

### ä»£ç 

```mysql
# Write your MySQL query statement below
SELECT 
	t2.spend_date,
	t1.platform,
    # t2.platform,
	sum(if(t1.platform = t2.platform, amount, 0)) total_amount,
	count(if(t1.platform = t2.platform, 1, NULL)) total_users
FROM (
	SELECT 'mobile' platform union 
    SELECT 'desktop' platform union
	SELECT 'both' platform 
) t1, 
(
	SELECT 
		user_id,
		spend_date, 
		any_value(if(count(platform) = 2, 'both', platform)) platform,
		sum(amount) amount
	FROM spending
	GROUP BY user_id, spend_date
) t2 
GROUP BY t2.spend_date, t1.platform;
```
# 4.ä¸¤ç§æ–¹æ³•è¯¦ç»†è§£ç­”â€”â€”ç”¨æˆ·è´­ä¹°å¹³å°
## SQLï¼šæ–¹æ³•ä¸€

```sql
select
	t1.spend_date,
	t1.platform,
	coalesce(sum(t2.amount), 0) total_amount,
	coalesce(sum(t2.users), 0) total_users
from (
	select spend_date, 'mobile' as platform from spending
	union
	select spend_date, 'desktop' as platform from spending
	union
	select spend_date, 'both' as platform from spending
) t1 left join (
	select 
		user_id,
		spend_date,
		any_value(
			case when count(platform) = 2 then 'both' else platform end
		) as platform,
		sum(amount) amount,
		count(distinct user_id) users
	from spending group by user_id, spend_date
) t2 on t1.spend_date = t2.spend_date and t1.platform = t2.platform
group by t1.spend_date, t1.platform order by t1.platform;
```

## åˆ†æ

åˆ†ä¸¤æ­¥ï¼Œåˆ†åˆ«æ„å»ºä¸€å¼ ä¸´æ—¶ï¼Œç„¶åä¸¤å¼ è¡¨è¿›è¡Œè”ç»“

- ç¬¬ä¸€å¼ è¡¨å­—æ®µæ˜¯æ—¥æœŸ `spend_date` å’Œå¹³å° `platform`
- ç¬¬äºŒå¼ è¡¨æ˜¯ç”¨æˆ· `user_id`ã€ `spend_date`ã€ `platform`ã€ `amount`ã€ `users`
    - ä¸€ä¸ªç”¨æˆ·åœ¨ä¸€å¤©å½“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `mobile` æˆ–è€… `desktop`ï¼Œä¹Ÿå¯ä»¥åŒæ—¶ä½¿ç”¨ã€‚
    - å¯ä»¥æŒ‰ç…§ç”¨æˆ·å’Œæ—¶é—´è¿›è¡Œåˆ†ç»„ï¼Œç®—å‡ºä¸€ä¸ªç”¨æˆ·ä¸€å¤©å½“ä¸­ä½¿ç”¨çš„å¹³å°ä»¥åŠæ€»æ”¯å‡ºé‡‘é¢
- å°†ä¸¤å¼ è¡¨é€šè¿‡ `spend_date` å’Œ `platform` è¿›è¡Œè”ç»“

## è§£æ

1. æŒ‰ç…§æ—¥æœŸå’Œå¹³å°æ„å»ºä¸´æ—¶è¡¨ `t1` ï¼Œä½œç”¨æ˜¯æ¯å¤©éƒ½æœ‰ä¸‰ä¸ªå¹³å°ï¼š `mobile`ã€`desktop`ã€`both`
    - ä½¿ç”¨ `union` å…³é”®å­—è”ç»“ä¸‰æ¬¡å­æŸ¥è¯¢
    
    ```sql
    select spend_date, 'mobile' as platform from spending
    union
    select spend_date, 'desktop' as platform from spending
    union
    select spend_date, 'both' as platform from spending
    ```
    
2. åŸºäº `spending` è¡¨ï¼ŒæŒ‰ç…§ `user_id`ã€ `spend_date` è¿›è¡Œåˆ†ç»„æŸ¥è¯¢ï¼Œä½œä¸ºä¸´æ—¶è¡¨ `t2`
    - ä½¿ç”¨ `case` è¯­å¥ï¼Œè®¡ç®—å‡º `platform` ï¼Œå¦‚æœä¸€ä¸ªç”¨æˆ·åœ¨ä¸€å¤©å½“ä¸­åŒæ—¶ä½¿ç”¨äº† `mobile` å’Œ `desktop` ï¼Œåˆ™ `platform` çš„å€¼æ˜¯ `both`
    - å¦‚æœä¸€ä¸ªç”¨æˆ·çš„ `platform = 'both'`ï¼Œè¿™ä¸ªç”¨æˆ·çš„å½“å¤©æ€»æ”¯å‡ºæ˜¯ `mobile` å’Œ `desktop` çš„ æ”¯å‡ºç›¸åŠ 
    - ä¸€ä¸ªç”¨æˆ·ä¸€å¤©åªèƒ½æ˜¯ä¸€ä¸ªå¹³å°ï¼Œæ‰€ä»¥è¦å»é‡ `count(distinct user_id) users`
    
    ```sql
    select 
    	user_id,
    	spend_date,
    	any_value(
    		case when count(platform) = 2 then 'both' else platform end
    	) as platform,
    	sum(amount) amount,
    	count(distinct user_id) users
    from spending group by user_id, spend_date
    ```
    
3. ä¸´æ—¶è¡¨ `t1` è”ç»“ä¸´æ—¶è¡¨ `t2` ï¼Œè”ç»“æ¡ä»¶æ˜¯ `spend_date` å’Œ `platform`
4. æŸ¥è¯¢è”ç»“åçš„è¡¨ï¼Œè®¡ç®—å‡ºæ¯å¤©æ¯ä¸ªå¹³å°çš„æ€»äººæ•°å’Œæ€»é‡‘é¢ï¼ŒæŒ‰ç…§ `t1.spend_date` å’Œ `t1.platform` è¿›è¡Œåˆ†ç»„
    - `coalesce(expr, expr, ...)` ï¼Œè¿”å›ç¬¬ä¸€ä¸ªéç©ºå€¼
    
    ```sql
    select
    	t1.spend_date,
    	t1.platform,
    	coalesce(sum(t2.amount), 0) total_amount,
    	coalesce(sum(t2.users), 0) total_users
    from ...
    ```
    

## SQLï¼šæ–¹æ³•äºŒ

```sql
select 
	t2.spend_date,
	t1.platform,
	sum(if(t1.platform = t2.platform, amount, 0)) as total_amount,
	count(if(t1.platform = t2.platform, 1, null)) as total_users
from (
	select 'mobile' as platform union
	select 'desktop' as platform union
	select 'both' as platform 
) t1, (
	select 
		user_id,
		spend_date, 
		any_value(if(count(platform) = 2, 'both', platform)) platform,
		sum(amount) amount
	from spending
	group by user_id, spend_date
) t2 group by t2.spend_date, t1.platform
```

## è§£æ

å’Œæ–¹æ³•ä¸€æ€è·¯ä¸€æ ·ï¼ŒåŒºåˆ«æ˜¯æ–¹æ³•äºŒç”¨çš„æ˜¯å†…è¿æ¥ã€‚

1. æ„å»º `t1` è¡¨åªéœ€è¦ä¸€ä¸ª `platform` ï¼Œå®ƒçš„ä½œç”¨æ˜¯ `spending` è¡¨ä¸­æ²¡æœ‰ `both` å­—æ®µï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯å›ºå®šè¾“å‡ºä¸‰ä¸ªå€¼ `mobile` ã€`desktop`ã€`both`
2. æ„å»º `t2` è¡¨çš„æ–¹æ³•å’Œæ–¹æ³•ä¸€ä¸€æ ·
3. å¯¹ `t1` å’Œ `t2` ä½¿ç”¨è‡ªè”ç»“ï¼Œæ²¡æœ‰æ¡ä»¶çš„è‡ªè”ç»“æ˜¯ä¸€ä¸ªç¬›å¡å°”ç§¯
    
    ```sql
    select * from t1, t2
    --- ç­‰ä»·äº
    select * from t1 join t2
    ```
    
4. æœ€ç»ˆç»“æœæ˜¯æ¯ä¸ªå¹³å°æ¯å¤©çš„ `æ€»ç”¨æˆ·æ•°`å’Œ `æ”¯å‡ºæ€»é‡‘é¢` ï¼Œæ‰€ä»¥ä½¿ç”¨æ—¥æœŸå’Œå¹³å°ä½œä¸ºåˆ†ç»„
    
    ```sql
    # ä¸€ä¸ªç”¨æˆ·åªèƒ½æ˜¯ä¸€ä¸ªå¹³å°ï¼ˆmobile/desktop/both), è¿™é‡Œçš„ amount åœ¨ t2 è¡¨ä¸­è¢«è®¡ç®—è¿‡äº†
    sum(if(t1.platform = t2.platform, amount, 0))
    
    # ä¸€ä¸ªç”¨æˆ·åªèƒ½æ˜¯ä¸€ä¸ªå¹³å°ï¼ˆmobile/desktop/bothï¼‰ï¼Œæ‰€ä»¥è¾“å‡º 1
    count(if(t1.platform = t2.platform, 1, null))
    ```
