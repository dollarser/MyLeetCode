# 1831æ¯å¤©çš„æœ€å¤§äº¤æ˜“
<p>è¡¨: <code>Transactions</code></p>

<pre>
+----------------+----------+
| Column Name    | Type     |
+----------------+----------+
| transaction_id | int      |
| day            | datetime |
| amount         | int      |
+----------------+----------+
transaction_id æ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚
æ¯è¡ŒåŒ…æ‹¬äº†è¯¥æ¬¡äº¤æ˜“çš„ä¿¡æ¯ã€‚
</pre>

<p>Â </p>

<p>å†™ä¸€æ¡ SQLÂ è¿”å›æ¯å¤©äº¤æ˜“é‡‘é¢ <code>amount</code> æœ€å¤§çš„äº¤æ˜“ ID ã€‚å¦‚æœæŸå¤©æœ‰å¤šä¸ªè¿™æ ·çš„äº¤æ˜“ï¼Œè¿”å›è¿™äº›äº¤æ˜“çš„ ID ã€‚</p>

<p><span style="">è¿”å›ç»“æœæ ¹æ® </span><code>transaction_id</code>Â å‡åºæ’åˆ—ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ·ä¾‹å¦‚ä¸‹ï¼š</p>

<p>Â </p>

<pre>
Transactions table:
+----------------+--------------------+--------+
| transaction_id | day                | amount |
+----------------+--------------------+--------+
| 8              | 2021-4-3 15:57:28  | 57     |
| 9              | 2021-4-28 08:47:25 | 21     |
| 1              | 2021-4-29 13:28:30 | 58     |
| 5              | 2021-4-28 16:39:59 | 40     |
| 6              | 2021-4-29 23:39:28 | 58     |
+----------------+--------------------+--------+

Result table:
+----------------+
| transaction_id |
+----------------+
| 1              |
| 5              |
| 6              |
| 8              |
+----------------+
"2021-4-3"  --> æœ‰ä¸€ä¸ª id æ˜¯ 8 çš„äº¤æ˜“ï¼Œå› æ­¤ï¼ŒæŠŠå®ƒåŠ å…¥ç»“æœè¡¨ã€‚ 
"2021-4-28" --> æœ‰ä¸¤ä¸ªäº¤æ˜“ï¼Œid æ˜¯ 5 å’Œ 9 ï¼Œäº¤æ˜“ 5 çš„é‡‘é¢æ˜¯ 40 ï¼Œè€Œäº¤æ˜“ 9 çš„æ•°é‡æ˜¯ 21 ã€‚åªéœ€è¦å°†äº¤æ˜“ 5 åŠ å…¥ç»“æœè¡¨ï¼Œå› ä¸ºå®ƒæ˜¯å½“å¤©é‡‘é¢æœ€å¤§çš„äº¤æ˜“ã€‚
"2021-4-29" --> æœ‰ä¸¤ä¸ªäº¤æ˜“ï¼Œid æ˜¯ 1 å’Œ 6 ï¼Œè¿™ä¸¤ä¸ªäº¤æ˜“çš„é‡‘é¢éƒ½æ˜¯ 58 ï¼Œå› æ­¤éœ€è¦æŠŠå®ƒä»¬éƒ½å†™å…¥ç»“æœè¡¨ã€‚
æœ€åï¼ŒæŠŠäº¤æ˜“ id æŒ‰ç…§å‡åºæ’åˆ—ã€‚</pre>

<p>Â </p>

<p><strong>è¿›é˜¶ï¼š</strong>ä½ å¯ä»¥ä¸ä½¿ç”¨Â <code>MAX()</code>Â å‡½æ•°è§£å†³è¿™é“é¢˜ç›®å—?</p>
































# è§£é¢˜:
# 1.ä¸ä½¿ç”¨å¼€çª—å‡½æ•°å®ç°ï¼Œåˆ†æ­¥éª¤æŸ¥è¯¢

1. å› ä¸ºæˆ‘ä»¬è¿”å›çš„æ¯å¤©æœ€å¤§äº¤æ˜“é‡‘é¢æ•°æ®å¯èƒ½æœ‰å¤šæ¡ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŸ¥å‡ºæ¯å¤©æœ€å¤§çš„äº¤æ˜“é‡‘é¢ï¼Œæ–¹ä¾¿åé¢è¿›è¡Œæ¯”å¯¹
```
select date_format(day, '%Y-%m-%d'), max(amount)
from Transactions 
group by date_format(day, '%Y-%m-%d')
```

2. æŸ¥å‡ºæ¯å¤©äº¤æ˜“é‡‘é¢ç­‰äºæœ€å¤§é‡‘é¢çš„è®¢å•idï¼šåªè¦æ—¥æœŸå’Œé‡‘é¢å¯¹å¾—ä¸Šæœ€å¤§çš„å°±å¯ä»¥äº†
```
select transaction_id
from Transactions
where (date_format(day, '%Y-%m-%d'), amount) in (
    select date_format(day, '%Y-%m-%d'), max(amount)
    from Transactions 
    group by date_format(day, '%Y-%m-%d')
)
group by transaction_id
order by transaction_id
```
# 2.çª—å£å‡½æ•°æ±‚æ¯å¤©çš„æœ€å¤§äº¤æ˜“
```
select transaction_id
from (
    select transaction_id, 
    dense_rank() over(partition by date_format(day,'%Y-%m-%d') order by amount desc) `rank`
    from Transactions
    order by transaction_id
) t1
where t1.`rank` = 1
```

# 3.DENSE_RANK() OVER(partition by TO_CHAR(T.day,'YYYY-MM-DD') order by T.amount desc)
### è§£é¢˜æ€è·¯
æœ¬æ¥æ²¡æƒ³å†™é¢˜è§£ï¼Œç»“æœå‘ç°æœ‰è¿™å¥è¯ï¼Œè¿™ä¸å¾—å†™ä¸€ä¸ªæ¥ç©ä¸‹
![image.png](https://pic.leetcode-cn.com/1662131615-oYOyzB-image.png)
çª—å£å‡½æ•°å³å¯

### ä»£ç 

```oraclesql
/* Write your PL/SQL query statement below */
SELECT IT.transaction_id 
FROM 
(
    SELECT TO_CHAR(T.day,'YYYY-MM-DD') AS day1,
    T.transaction_id,
    T.amount,
    DENSE_RANK() OVER(partition by TO_CHAR(T.day,'YYYY-MM-DD') order by T.amount desc) AS TT
    FROM Transactions T 
) IT
WHERE IT.TT = 1
ORDER BY IT.transaction_id 

```
# 4.ã€track & traningã€‘æ€è·¯ç®€å•ï¼Œæ€§èƒ½é«˜æ•ˆ
### æ–¹ä¾¿å¿«é€Ÿå­¦ä¹ ç®—æ³•ä¸ç†è§£~
ğŸŒ‡ ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ ä¸€é”®ä¸‰è¿ ~å…³æ³¨Jamï¼Œä»ä½ æˆ‘åšèµ·ï¼

**å…„å¼Ÿä¼šèƒŒå›ä½ ï¼Œå¥³äººä¼šç¦»å¼€ä½ ï¼Œé‡‘é’±ä¼šè¯±æƒ‘ä½ ï¼Œç”Ÿæ´»ä¼šåˆéš¾ä½ ï¼Œåªæœ‰æ•°å­¦ä¸ä¼šï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼š**
**å¤©æ‰ä¸å¦ï¼Œå–å†³äºæœ€ç»ˆè¾¾åˆ°çš„é«˜åº¦ã€‚çœŸæ­£çš„å¤©æ‰æ˜¯é‚£äº›è„šè¸å®åœ°çš„äºº**
**é™ä¸‹å¿ƒæ¥å¥½å¥½åšè‡ªå·±ï¼Œèµ°ç¨³è„šä¸‹æ¯ä¸€æ­¥ï¼Œå°±æ˜¯æœ€å¥½çš„è·¯ï¼Œå¼ºè€…éƒ½æ˜¯å­¤ç‹¬çš„**

æ¨è python ç®—æ³•çš„ä¹¦ç±ï¼Œä½“ç³»åŒ–å­¦ä¹ ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œç”¨æ­£ç¡®çš„æ–¹å¼æˆä¸ºofferæ”¶å‰²æœº
[leetcode](https://github.com/ls1248659692/leetcode) â€”â€”  **ç³»ç»ŸåŒ–å¿«é€Ÿå­¦ä¹ ç®—æ³•ï¼Œè¿™ä¸æ˜¯å†…å·ï¼Œè¿™åªæ˜¯æ‚„æ‚„åœ°åŠªåŠ›ï¼Œç„¶åæƒŠè‰³æ‰€æœ‰çš„äºº**
![image.png](https://pic.leetcode-cn.com/1649569354-bSVeOt-image.png)

---
### æ±‚è§£æ€è·¯
æš´åŠ›ç ´è§£

### ä»£ç 

```mysql
# Write your MySQL query statement below
SELECT
    transaction_id
FROM transactions
WHERE (DATE(day), amount) in (
SELECT 
    DATE(day), MAX(amount)
FROM 
    transactions 
GROUP BY DATE(day)
HAVING amount = MAX(amount)
)
ORDER BY transaction_id;
```
