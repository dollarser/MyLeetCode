# 1571ä»“åº“ç»ç†
<p>è¡¨:&nbsp;<code>Warehouse</code></p>

<pre>
+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| name         | varchar |
| product_id   | int     |
| units        | int     |
+--------------+---------+
(name, product_id) æ˜¯è¯¥è¡¨ä¸»é”®.
è¯¥è¡¨çš„è¡ŒåŒ…å«äº†æ¯ä¸ªä»“åº“çš„æ‰€æœ‰å•†å“ä¿¡æ¯.
</pre>

<p>&nbsp;</p>

<p>è¡¨: <code>Products</code></p>

<pre>
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| product_id    | int     |
| product_name  | varchar |
| Width         | int     |
| Length        | int     |
| Height        | int     |
+---------------+---------+
product_id æ˜¯è¯¥è¡¨ä¸»é”®.
è¯¥è¡¨çš„è¡ŒåŒ…å«äº†æ¯ä»¶å•†å“ä»¥è‹±å°ºä¸ºå•ä½çš„å°ºå¯¸(å®½åº¦, é•¿åº¦å’Œé«˜åº¦)ä¿¡æ¯.
</pre>

<p>&nbsp;</p>

<p>å†™ä¸€ä¸ª SQL&nbsp;æŸ¥è¯¢æ¥æŠ¥å‘Š,&nbsp;æ¯ä¸ªä»“åº“çš„å­˜è´§é‡æ˜¯å¤šå°‘ç«‹æ–¹è‹±å°º.</p>

<p>è¿”å›ç»“æœæ²¡æœ‰é¡ºåºè¦æ±‚.</p>

<p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ä¾‹æ‰€ç¤º.</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<pre>
<code><strong>è¾“å…¥ï¼š</strong>
Warehouse è¡¨</code>:
+------------+--------------+-------------+
| name       | product_id   | units       |
+------------+--------------+-------------+
| LCHouse1   | 1            | 1           |
| LCHouse1   | 2            | 10          |
| LCHouse1   | 3            | 5           |
| LCHouse2   | 1            | 2           |
| LCHouse2   | 2            | 2           |
| LCHouse3   | 4            | 1           |
+------------+--------------+-------------+
Products è¡¨:
+------------+--------------+------------+----------+-----------+
| product_id | product_name | Width      | Length   | Height    |
+------------+--------------+------------+----------+-----------+
| 1          | LC-TV        | 5          | 50       | 40        |
| 2          | LC-KeyChain  | 5          | 5        | 5         |
| 3          | LC-Phone     | 2          | 10       | 10        |
| 4          | LC-T-Shirt   | 4          | 10       | 20        |
+------------+--------------+------------+----------+-----------+
<strong>è¾“å‡ºï¼š</strong>
+----------------+------------+
| <code>WAREHOUSE_NAME </code>| <code>VOLUME   </code>  | 
+----------------+------------+
| LCHouse1       | 12250      | 
| LCHouse2       | 20250      |
| LCHouse3       | 800        |
+----------------+------------+
<strong>è§£é‡Šï¼š</strong>
Idä¸º1çš„å•†å“(LC-TV)çš„å­˜è´§é‡ä¸º 5x50x40 = 10000
Idä¸º2çš„å•†å“(LC-KeyChain)çš„å­˜è´§é‡ä¸º 5x5x5 = 125 
Idä¸º3çš„å•†å“(LC-Phone)çš„å­˜è´§é‡ä¸º 2x10x10 = 200
Idä¸º4çš„å•†å“(LC-T-Shirt)çš„å­˜è´§é‡ä¸º 4x10x20 = 800
ä»“åº“LCHouse1: 1ä¸ªå•ä½çš„LC-TV + 10ä¸ªå•ä½çš„LC-KeyChain + 5ä¸ªå•ä½çš„LC-Phone.
&nbsp;         æ€»å­˜è´§é‡ä¸º: 1*10000 + 10*125  + 5*200 = 12250 ç«‹æ–¹è‹±å°º
ä»“åº“LCHouse2: 2ä¸ªå•ä½çš„LC-TV + 2ä¸ªå•ä½çš„LC-KeyChain.
&nbsp;         æ€»å­˜è´§é‡ä¸º: 2*10000 + 2*125 = 20250 ç«‹æ–¹è‹±å°º
ä»“åº“LCHouse3: 1ä¸ªå•ä½çš„LC-T-Shirt.
          æ€»å­˜è´§é‡ä¸º: 1*800 = 800 ç«‹æ–¹è‹±å°º.</pre>
































# è§£é¢˜:
# 1.JOIN+èšåˆå‡½æ•° mysql+oracle
# mysql
Join + èšåˆå‡½æ•°
```
# Write your MySQL query statement below
SELECT W.name AS WAREHOUSE_NAME,
       SUM(W.units*P.Width*P.Length*P.Height) AS VOLUME
  FROM Warehouse AS W 
  LEFT JOIN Products AS P 
  ON W.product_id=P.product_id
  GROUP BY W.name;
# LEFT JOIN
```
# oracle
WHERE + èšåˆå‡½æ•°
```
/* Write your PL/SQL query statement below */
SELECT W.name WAREHOUSE_NAME,
       SUM(W.units*P.Width*P.Length*P.Height) VOLUME
  FROM Warehouse W, Products P 
  WHERE W.product_id=P.product_id
  GROUP BY W.name
  ORDER BY W.name;
```
# é€šè¿‡
![image.png](https://pic.leetcode.cn/1680966175-YuDkMG-image.png)

# 2.ä»“åº“ç»ç†
# Write your MySQL query statement below

select name as WAREHOUSE_NAME, sum(total_v) as VOLUME
from (select name, w.product_id, (units * v) as total_v
      from Warehouse as w
               join (select product_id, (width * length * height) as v
                     from products) as t on w.product_id = t.product_id) as a
group by WAREHOUSE_NAME;

select w.name as WAREHOUSE_NAME, sum(p.width * p.length * p.height * w.units) as VOLUME
from Warehouse as w
         join products as p
              on w.product_id = p.product_id
group by WAREHOUSE_NAME;


# 3.ã€track & traningã€‘æ€è·¯ç®€å•ï¼Œæ€§èƒ½é«˜æ•ˆ
### æ–¹ä¾¿å¿«é€Ÿå­¦ä¹ ç®—æ³•ä¸ç†è§£~
ğŸŒ‡ ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ ä¸€é”®ä¸‰è¿ ~å…³æ³¨Jamï¼Œä»ä½ æˆ‘åšèµ·ï¼

**å…„å¼Ÿä¼šèƒŒå›ä½ ï¼Œå¥³äººä¼šç¦»å¼€ä½ ï¼Œé‡‘é’±ä¼šè¯±æƒ‘ä½ ï¼Œç”Ÿæ´»ä¼šåˆéš¾ä½ ï¼Œåªæœ‰æ•°å­¦ä¸ä¼šï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼š**
**å¤©æ‰ä¸å¦ï¼Œå–å†³äºæœ€ç»ˆè¾¾åˆ°çš„é«˜åº¦ã€‚çœŸæ­£çš„å¤©æ‰æ˜¯é‚£äº›è„šè¸å®åœ°çš„äºº**
**é™ä¸‹å¿ƒæ¥å¥½å¥½åšè‡ªå·±ï¼Œèµ°ç¨³è„šä¸‹æ¯ä¸€æ­¥ï¼Œå°±æ˜¯æœ€å¥½çš„è·¯ï¼Œå¼ºè€…éƒ½æ˜¯å­¤ç‹¬çš„**

æ¨è python ç®—æ³•çš„ä¹¦ç±ï¼Œä½“ç³»åŒ–å­¦ä¹ ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œç”¨æ­£ç¡®çš„æ–¹å¼æˆä¸ºofferæ”¶å‰²æœº
[leetcode](https://github.com/ls1248659692/leetcode) â€”â€”  **ç³»ç»ŸåŒ–å¿«é€Ÿå­¦ä¹ ç®—æ³•ï¼Œè¿™ä¸æ˜¯å†…å·ï¼Œè¿™åªæ˜¯æ‚„æ‚„åœ°åŠªåŠ›ï¼Œç„¶åæƒŠè‰³æ‰€æœ‰çš„äºº**
![image.png](https://pic.leetcode-cn.com/1649565338-dfnMOx-image.png)

---
### æ±‚è§£æ€è·¯
æš´åŠ›ç ´è§£

### ä»£ç 

```mysql
# Write your MySQL query statement below
SELECT 
    w.name WAREHOUSE_NAME,
    SUM(p.Width * p.Length * p.Height * w.units) VOLUME
FROM 
    warehouse w
LEFT JOIN 
    products p
ON 
    w.product_id = p.product_id
GROUP BY w.name;
```
# 4.SQL-Left Join å­æŸ¥è¯¢ + èšåˆå‡½æ•°
```sql
select w.name as warehouse_name, SUM(T.capacity * w.units) as volume from warehouse w
left join 
(
    select product_id, (width * length * height) as capacity from products
) T
on w.product_id = T.product_id
group by w.name
```

