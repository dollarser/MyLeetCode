# 1082é”€å”®åˆ†æ I 
<p>äº§å“è¡¨ï¼š<code>Product</code></p>

<pre>
+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| product_id   | int     |
| product_name | varchar |
| unit_price   | int     |
+--------------+---------+
product_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®.
è¯¥è¡¨çš„æ¯ä¸€è¡Œæ˜¾ç¤ºæ¯ä¸ªäº§å“çš„åç§°å’Œä»·æ ¼ã€‚
</pre>

<p>é”€å”®è¡¨ï¼š<code>Sales</code></p>

<pre>
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| seller_id   | int     |
| product_id  | int     |
| buyer_id    | int     |
| sale_date   | date    |
| quantity    | int     |
| price       | int     |
+------ ------+---------+
è¿™ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯ä»¥æœ‰é‡å¤çš„è¡Œã€‚ 
product_id æ˜¯ Product è¡¨çš„å¤–é”®ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å…³äºä¸€ä¸ªé”€å”®çš„ä¸€äº›ä¿¡æ¯ã€‚
</pre>

<p>&nbsp;</p>

<p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ€»é”€å”®é¢æœ€é«˜çš„é”€å”®è€…ï¼Œå¦‚æœæœ‰å¹¶åˆ—çš„ï¼Œå°±éƒ½å±•ç¤ºå‡ºæ¥ã€‚</p>

<p>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>
Product è¡¨ï¼š
+------------+--------------+------------+
| product_id | product_name | unit_price |
+------------+--------------+------------+
| 1          | S8           | 1000       |
| 2          | G4           | 800        |
| 3          | iPhone       | 1400       |
+------------+--------------+------------+
<code>Sales </code>è¡¨ï¼š
+-----------+------------+----------+------------+----------+-------+
| seller_id | product_id | buyer_id | sale_date  | quantity | price |
+-----------+------------+----------+------------+----------+-------+
| 1         | 1          | 1        | 2019-01-21 | 2        | 2000  |
| 1         | 2          | 2        | 2019-02-17 | 1        | 800   |
| 2         | 2          | 3        | 2019-06-02 | 1        | 800   |
| 3         | 3          | 4        | 2019-05-13 | 2        | 2800  |
+-----------+------------+----------+------------+----------+-------+
<strong>è¾“å‡ºï¼š</strong>
+-------------+
| seller_id   |
+-------------+
| 1           |
| 3           |
+-------------+
<strong>è§£é‡Šï¼š</strong>Id ä¸º 1 å’Œ 3 çš„é”€å”®è€…ï¼Œé”€å”®æ€»é‡‘é¢éƒ½ä¸ºæœ€é«˜çš„ 2800ã€‚</pre>
































# è§£é¢˜:
# 1.PARTITION BY å’ŒGROUP BY çš„ä½¿ç”¨åŒºåˆ«
æœ¬é¢˜è¿™æ ·æ­£ç¡®ï¼š
```
SELECT seller_id FROM 
(SELECT seller_id , RANK() OVER(ORDER BY SUM(price) DESC) AS r
FROM Sales GROUP BY seller_id) s
WHERE s.r=1;
```

è¿™æ ·åè€Œé”™è¯¯ï¼š
```
SELECT seller_id FROM 
(SELECT seller_id , RANK() OVER(PARTITION BY seller_idORDER BY SUM(price) DESC) AS r
FROM Sales ) s
WHERE s.r=1;
```

   æ³¨æ„å­æŸ¥è¯¢é‡Œé¢çš„æ‰§è¡Œé¡ºåºï¼Œæ˜¯å…ˆfrom salesï¼Œå†group by seller_idï¼Œæœ€åå†selectï¼Œè¿™æ ·å¾—åˆ°çš„å°±æ˜¯seller_idå’Œæ¯ä¸ªseller_idå¯¹åº”çš„sum(price)çš„æ’åã€‚å¦‚æœæ¢æˆpartition by seller_idå°±æ˜¯åœ¨æ¯ä¸ªseller_idç»„å†…å¯¹priceæ’åºäº†
   ç»“åˆ1076å’Œ1077é¢˜ä¸€èµ·ä½“ä¼šä¸‹åŒºåˆ«ã€‚
# 2.all å‡½æ•°å’Œ any 
### è§£é¢˜æ€è·¯
maxå’Œallå‡½æ•°èµ·åˆ°çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œ allå’Œæ¯ä¸€ä¸ªè¿›è¡Œæ¯”è¾ƒï¼ˆå¤§äºæœ€å¤§çš„æˆ–è€…å°äºæœ€å°çš„ï¼‰
any åˆ™æ˜¯å¤§äºä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥ï¼ˆå¤§äºæœ€å°çš„ï¼Œå°äºæœ€å¤§çš„ï¼‰

éå¸¸æœ‰ç”¨çš„ä¸¤ä¸ªå‡½æ•°

### ä»£ç 

```mysql
# Write your MySQL query statement below

select
    seller_id
from
    sales
group by seller_id
having
sum(price) >= all(select sum(price) from sales group by seller_id)


```
# 3.1082.é”€å”®åˆ†æI
```
# Write your MySQL query statement below
select seller_id from Sales
group by seller_id
having sum(price) >= all(
    select sum(price) from Sales group by seller_id
);
```

# 4.ã€track & traningã€‘æ€è·¯ç®€å•ï¼Œæ€§èƒ½é«˜æ•ˆæ¥è¿‘90
### æ–¹ä¾¿å¿«é€Ÿå­¦ä¹ ç®—æ³•ä¸ç†è§£~
ğŸŒ‡ ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ ä¸€é”®ä¸‰è¿ ~å…³æ³¨Jamï¼Œä»ä½ æˆ‘åšèµ·ï¼

**å…„å¼Ÿä¼šèƒŒå›ä½ ï¼Œå¥³äººä¼šç¦»å¼€ä½ ï¼Œé‡‘é’±ä¼šè¯±æƒ‘ä½ ï¼Œç”Ÿæ´»ä¼šåˆéš¾ä½ ï¼Œåªæœ‰æ•°å­¦ä¸ä¼šï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼š**
**å¤©æ‰ä¸å¦ï¼Œå–å†³äºæœ€ç»ˆè¾¾åˆ°çš„é«˜åº¦ã€‚çœŸæ­£çš„å¤©æ‰æ˜¯é‚£äº›è„šè¸å®åœ°çš„äºº**
**é™ä¸‹å¿ƒæ¥å¥½å¥½åšè‡ªå·±ï¼Œèµ°ç¨³è„šä¸‹æ¯ä¸€æ­¥ï¼Œå°±æ˜¯æœ€å¥½çš„è·¯ï¼Œå¼ºè€…éƒ½æ˜¯å­¤ç‹¬çš„**

æ¨è python ç®—æ³•çš„ä¹¦ç±ï¼Œä½“ç³»åŒ–å­¦ä¹ ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œç”¨æ­£ç¡®çš„æ–¹å¼æˆä¸ºofferæ”¶å‰²æœº
[leetcode](https://github.com/ls1248659692/leetcode) â€”â€”  **ç³»ç»ŸåŒ–å¿«é€Ÿå­¦ä¹ ç®—æ³•ï¼Œè¿™ä¸æ˜¯å†…å·ï¼Œè¿™åªæ˜¯æ‚„æ‚„åœ°åŠªåŠ›ï¼Œç„¶åæƒŠè‰³æ‰€æœ‰çš„äºº**
![image.png](https://pic.leetcode-cn.com/1649564924-CbNyFj-image.png)


---
### æ±‚è§£æ€è·¯
1.  GROUP BY HAVING
2. all
3. sum


### ä»£ç 

```mysql
# Write your MySQL query statement below
SELECT
    seller_id
FROM
    sales
GROUP BY seller_id
HAVING sum(price) >= all(
SELECT 
    sum(price) 
FROM sales 
GROUP BY seller_id
);
```
