# 2066è´¦æˆ·ä½™é¢
<p>è¡¨å: <code>Transactions</code></p>

<pre>
+-------------+------+
| Column Name | Type |
+-------------+------+
| account_id  | int  |
| day         | date |
| type        | ENUM |
| amount      | int  |
+-------------+------+
(account_id, day) æ˜¯è¯¥Transactionsè¡¨çš„ä¸»é”®.
è¡¨ä¸­çš„æ¯è¡Œæ•°æ®è¡¨ç¤ºä¸€æ¬¡äº¤æ˜“çš„ä¿¡æ¯, åŒ…æ‹¬æ­¤æ¬¡äº¤æ˜“çš„è´¦å·(account_id), äº¤æ˜“ç±»å‹(type), äº¤æ˜“å‘ç”Ÿæ—¶é—´(day), äº¤æ˜“å‘ç”Ÿé‡‘é¢(amount).
å…¶ä¸­äº¤æ˜“ç±»å‹(type)å­—æ®µåŒ…æ‹¬äº†ä¸¤ç§è¡Œä¸ºï¼šå­˜å…¥ ('Deposit'), å–å‡º('Withdraw').
</pre>

<p>&nbsp;</p>

<p>è¯·å†™å‡ºèƒ½å¤Ÿè¿”å›ç”¨æˆ·æ¯æ¬¡äº¤æ˜“å®Œæˆåçš„è´¦æˆ·ä½™é¢. æˆ‘ä»¬çº¦å®šæ‰€æœ‰ç”¨æˆ·åœ¨è¿›è¡Œäº¤æ˜“å‰çš„è´¦æˆ·ä½™é¢éƒ½ä¸º0ï¼Œ&nbsp;å¹¶ä¸”ä¿è¯æ‰€æœ‰äº¤æ˜“è¡Œä¸ºåçš„ä½™é¢ä¸ä¸ºè´Ÿæ•°ã€‚</p>

<p>è¿”å›çš„ç»“æœè¯·ä¾æ¬¡æŒ‰ç…§ è´¦æˆ·ï¼ˆ<code>account_id</code>),&nbsp;æ—¥æœŸ(&nbsp;<code>day</code>&nbsp;) è¿›è¡Œ<strong>å‡åºæ’åº</strong>&nbsp;.</p>

<p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼è¯·å‚ç…§ä»¥ä¸‹æµ‹è¯•æ ·ä¾‹.</p>

<p>&nbsp;</p>

<p><strong>æµ‹è¯•æ ·ä¾‹1:</strong></p>

<pre>
<strong>è¾“å…¥:</strong> 
Transactions è¡¨:
+------------+------------+----------+--------+
| account_id | day        | type     | amount |
+------------+------------+----------+--------+
| 1          | 2021-11-07 | Deposit  | 2000   |
| 1          | 2021-11-09 | Withdraw | 1000   |
| 1          | 2021-11-11 | Deposit  | 3000   |
| 2          | 2021-12-07 | Deposit  | 7000   |
| 2          | 2021-12-12 | Withdraw | 7000   |
+------------+------------+----------+--------+
<strong>è¾“å‡º:</strong> 
+------------+------------+---------+
| account_id | day        | balance |
+------------+------------+---------+
| 1          | 2021-11-07 | 2000    |
| 1          | 2021-11-09 | 1000    |
| 1          | 2021-11-11 | 4000    |
| 2          | 2021-12-07 | 7000    |
| 2          | 2021-12-12 | 0       |
+------------+------------+---------+

<strong>è§£é‡Š:</strong> 
è´¦æˆ·1:
- åˆå§‹é‡‘é¢ä¸º 0.
- 2021-11-07 --&gt; å­˜å…¥2000. ä½™é¢å˜ä¸º 0 + 2000 = 2000.
- 2021-11-09 --&gt; å–å‡º1000. ä½™é¢å˜ä¸º 2000 - 1000 = 1000.
- 2021-11-11 --&gt; å­˜å…¥3000. ä½™é¢å˜ä¸º 1000 + 3000 = 4000.
è´¦æˆ·2:
- åˆå§‹é‡‘é¢ä¸º 0.
- 2021-12-07 --&gt; å­˜å…¥7000. ä½™é¢å˜ä¸º 0 + 7000 = 7000.
- 2021-12-12 --&gt; å–å‡º 7000. ä½™é¢å˜ä¸º 7000 - 7000 = 0.
</pre>
































# è§£é¢˜:
# 1.ã€track & traningã€‘æ€è·¯ç®€å•ï¼Œæ€§èƒ½é«˜æ•ˆ
### æ–¹ä¾¿å¿«é€Ÿå­¦ä¹ ç®—æ³•ä¸ç†è§£~
ğŸŒ‡ ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ ä¸€é”®ä¸‰è¿ ~å…³æ³¨Jamï¼Œä»ä½ æˆ‘åšèµ·ï¼

**å…„å¼Ÿä¼šèƒŒå›ä½ ï¼Œå¥³äººä¼šç¦»å¼€ä½ ï¼Œé‡‘é’±ä¼šè¯±æƒ‘ä½ ï¼Œç”Ÿæ´»ä¼šåˆéš¾ä½ ï¼Œåªæœ‰æ•°å­¦ä¸ä¼šï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼š**
**å¤©æ‰ä¸å¦ï¼Œå–å†³äºæœ€ç»ˆè¾¾åˆ°çš„é«˜åº¦ã€‚çœŸæ­£çš„å¤©æ‰æ˜¯é‚£äº›è„šè¸å®åœ°çš„äºº**
**é™ä¸‹å¿ƒæ¥å¥½å¥½åšè‡ªå·±ï¼Œèµ°ç¨³è„šä¸‹æ¯ä¸€æ­¥ï¼Œå°±æ˜¯æœ€å¥½çš„è·¯ï¼Œå¼ºè€…éƒ½æ˜¯å­¤ç‹¬çš„**

æ¨è python ç®—æ³•çš„ä¹¦ç±ï¼Œä½“ç³»åŒ–å­¦ä¹ ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œç”¨æ­£ç¡®çš„æ–¹å¼æˆä¸ºofferæ”¶å‰²æœº
[leetcode](https://github.com/ls1248659692/leetcode) â€”â€”  **ç³»ç»ŸåŒ–å¿«é€Ÿå­¦ä¹ ç®—æ³•ï¼Œè¿™ä¸æ˜¯å†…å·ï¼Œè¿™åªæ˜¯æ‚„æ‚„åœ°åŠªåŠ›ï¼Œç„¶åæƒŠè‰³æ‰€æœ‰çš„äºº**

---
### æ±‚è§£æ€è·¯
1. CASE WHEN

### ä»£ç 

```mysql
# Write your MySQL query statement below
SELECT 
    account_id, day,
    sum(case when type = 'Deposit' then amount else -amount end) over (partition by account_id order by day) balance
FROM 
    transactions
ORDER BY 
    account_id,day;
```
# 2.å‡»è´¥äº†94.44%çš„ç”¨æˆ·
### è§£é¢˜æ€è·¯

æ‰§è¡Œç”¨æ—¶ï¼š
452 ms, åœ¨æ‰€æœ‰ MySQL æäº¤ä¸­å‡»è´¥äº†94.44%çš„ç”¨æˆ·
å†…å­˜æ¶ˆè€—ï¼š
0 B, åœ¨æ‰€æœ‰ MySQL æäº¤ä¸­å‡»è´¥äº†100.00%çš„ç”¨æˆ·

### ä»£ç 

```mysql
# Write your MySQL query statement below
select account_id
    ,day
    ,sum(case when type = 'Deposit' then +amount
        else -amount end) over (partition by account_id order by day)  balance
from Transactions
order by 1,2
```
# 3.ä¸ç”¨å­æŸ¥è¯¢äº†
```
select account_id,day,
    sum(if(type='deposit',1,-1) *amount )
     over(partition by account_id order by day) balance
from Transactions

order by account_id,day
```

# 4.Account Balance



### ä»£ç 

```oraclesql
/* Write your PL/SQL query statement below */



SELECT 
ACCOUNT_ID,
TO_CHAR(DAY,'YYYY-MM-DD') AS DAY,
SUM(CASE WHEN TYPE = 'Deposit' THEN AMOUNT ELSE 0-AMOUNT END) OVER(PARTITION BY ACCOUNT_ID ORDER BY ACCOUNT_ID, DAY ASC) AS BALANCE
FROM TRANSACTIONS
```
